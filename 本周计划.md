# 第 2 周学习计划（可保存）

## 周目标（总 20h）

- 将第 1 周单体项目拆分为至少 2 个独立服务（示例：user-service / order-service）。
- 使用 Docker Compose 在本地联调多服务环境。
- 搭建基础 CI（GitHub Actions）：自动构建与运行单元测试。
- 产出：拆分后的代码结构、docker-compose.yml、一个 CI workflow、更新的 README 与 1 篇简短技术笔记。

---

## 时间分配建议

- 工作日（周一～周五）：每天 2h（共 10h）
- 周末（周六～周日）：每天 5h（共 10h）

---

## 每日计划

### 第 1 天（周一，2h） — 设计服务边界

- 任务：
  - 确定拆分边界（按功能/领域划分），列出每个服务的责任与 API（接口契约）。
  - 画简单架构图（1 张），写接口契约示例（请求/响应 JSON）。
- 交付：services.md（列出服务、端点、依赖关系）+ 简单架构图（ASCII 或图片链接）。

建议产物示例（services.md）：

- user-service: 注册/登录/查询（POST /api/users, GET /api/users/{id}）
- order-service: 下单/查询（POST /api/orders, GET /api/orders/{id}）
- 说明调用链：order -> user（通过 REST 或消息）

---

### 第 2 天（周二，2h） — 新建子模块与项目结构

- 任务：
  - 基于现有项目新建两个模块或两个独立 Maven 项目（建议使用 multi-module 或独立 repo）。
  - 迁移相关代码（Controller/Service/Entity），保留公共模型或创建 common 库（如需要）。
- 命令参考（示例 multi-module）：

```bash
mvn -N io.takari:maven:wrapper
mvn archetype:generate ...
# 或手工创建 modules 并更新 parent pom.xml
```

- 交付：项目结构草稿（文件夹/模块列表）+ 能单独启动的两个服务骨架（端口不同）。

---

### 第 3 天（周三，2h） — 本地容器化与 Docker Compose

- 任务：
  - 为两个服务各写 Dockerfile，确保镜像能本地构建。
  - 编写 docker-compose.yml，包含服务与依赖（如 MySQL 或 Redis）。
- 关键命令：

```bash
# 在每个服务目录
docker build -t user-service:week2 .
docker build -t order-service:week2 .

# 在项目根
docker-compose up --build
```

- 交付：docker-compose.yml + 可通过 docker-compose 启动的联调环境（两个服务可互相访问）。

---

### 第 4 天（周四，2h） — 接口契约与集成验证

- 任务：
  - 完成微服务间基本调用（RestTemplate/WebClient 或 Feign），实现一个端到端流程（例如：创建订单时校验用户）。
  - 使用 Postman 或 curl 验证端到端请求链路。
- 示例 curl：

```bash
curl -X POST http://localhost:8081/api/orders -d '{"userId":1,"items":[...]}'
```

- 交付：curl 命令示例 + 验证截图/日志片段（粘贴到 README）。

---

### 第 5 天（周五，2h） — 搭建 GitHub Actions CI（基础）

- 任务：
  - 在仓库根添加 .github/workflows/ci.yml：触发 push/pull_request，步骤包含 checkout、maven build、运行单元测试。
- 简单 CI 模板（供复制）：

```yaml
name: CI
on: [push, pull_request]
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Set up JDK 17
        uses: actions/setup-java@v4
        with:
          java-version: "17"
          distribution: "temurin"
      - name: Build with Maven
        run: mvn -B clean package -DskipTests=false
```

- 交付：ci.yml 文件 + 第一次通过的 CI 运行记录（或本地验证日志）。

---

### 第 6 天（周六，5h） — 完善 CI 与本地调试体验

- 任务（分阶段）：
  - 完整跑通 CI（修复构建/测试失败）。
  - 在 README 中加入“本地开发与联调”指南：如何用 docker-compose，如何单服务调试（IDE 端口映射）。
  - 若时间允许：在 CI 中加入 Docker 镜像构建步骤（可先推到 GitHub Container Registry）。
- 交付：更新后的 README（包含 CI 状态徽章 和 本地运行步骤）。

---

### 第 7 天（周日，5h） — 编写技术笔记与复盘

- 任务：
  - 撰写 1 篇短技术笔记（约 400-800 字），主题可选：
    - 微服务拆分思路与遇到的问题
    - Docker Compose 在本地联调的注意点
    - CI 初步配置经验
  - 做周复盘：记录未完成项、下周优先级（K8s/Observability）。
- 交付：tech-note.md + 周复盘文档（issue 或 TODO 列表）。

---

## 周验收标准（可量化）

- 成果需满足：
  - 至少 2 个可独立启动的服务（user-service、order-service）。
  - docker-compose 一键启动并能跑通一个端到端场景。
  - GitHub Actions CI 能在 push 后触发并通过构建与单元测试。
  - README 更新 + 1 篇技术笔记发布到仓库（tech-note.md）。

---

## 关键资源（短链）

- Docker & Docker Compose 文档
- GitHub Actions 官方示例（Java/Maven）
- Spring RestTemplate / WebClient / OpenFeign 教程
- Postman 或 curl 用于接口验证

---

## 下一步建议（如果完成）

- 第 3 周：把服务部署到本地 Kubernetes（minikube/k3d）并接入基本监控（Prometheus/Grafana）。
